{
  "editing": {
    "content": "",
    "preview": "",
    "tags": []
  },
  "notes": [
    {
      "content": "Babel çš„åŠŸèƒ½åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š\n\n- è½¬æ¢è¯­æ³•\n- polyfill æ–°çš„ APIï¼Œæ¯”å¦‚ Promise Set Map è¿™äº› API\n\næ‰€æœ‰çš„è¿™äº›éƒ½æ˜¯é€šè¿‡æ’ä»¶æ¥å®ç°çš„ã€‚\n\npreset ä¸­åŒ…å«äº†å¤§é‡çš„æ’ä»¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸€ä¸ªä¸ªä¸‹è½½æ’ä»¶ï¼Œç„¶åé…ç½®ï¼Œç›´æ¥é…ç½® preset å°±å¯ä»¥äº†ï¼Œå¹¶ä¸”è¿˜ä¼šæ ¹æ® targetï¼Œæœ‰æ¡ä»¶çš„è½¬æ¢è¯­æ³•ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªè¯­æ³•éƒ½ä¼šè½¬æ¢ã€‚\n\né™¤æ­¤ä¹‹å¤–ï¼Œpreset è¿˜å¯ä»¥é€šè¿‡ useBuiltIns é€‰é¡¹æ¥æ·»åŠ  polyfillï¼Œä¸è¿‡æ˜¯å…¨å±€æ·»åŠ çš„æ–¹å¼ã€‚\n\nå¯ä»¥é€šè¿‡æ’ä»¶ transform-runtime æ¥æ·»åŠ  polyfillï¼Œå®ƒä¸ä¼šæ·»åŠ åˆ°å…¨å±€ä¸­ï¼Œä»è€Œä¸ä¼šæ±¡æŸ“ç¯å¢ƒï¼Œä½†æ˜¯ä»–ä¸ä¼šæ ¹æ®ä½ çš„ taget æœ‰æ¡ä»¶çš„æ·»åŠ ï¼Œè€Œæ˜¯ä½ ç”¨åˆ°çš„éƒ½ä¼šæ·»åŠ ï¼Œæ¯”å¦‚ä½ çš„ taget æµè§ˆå™¨å·²ç»æ”¯æŒ Promise äº†ï¼Œä½†æ˜¯ transform-runtime è¿˜æ˜¯ä¼šæ·»åŠ ï¼Œä½†æ˜¯è¿™æ˜¯ä¸å¿…è¦ã€‚\n\nå®˜æ–¹æ–‡æ¡£çš„å»ºè®®æ˜¯ preset-env çš„ useBuiltin é€‰é¡¹å’Œ transform-runtime ä¸è¦åŒæ—¶ä½¿ç”¨ï¼Œä¸€èˆ¬åº“ä½œè€…ä¼šä½¿ç”¨ transform-runtimeï¼Œå› ä¸ºä¸ä¼šæ±¡æŸ“å…¨å±€ï¼Œè€Œåº”ç”¨ä¼šä½¿ç”¨ useBuiltInsï¼Œå› ä¸ºå¯ä»¥å‡å°‘ä½“ç§¯ã€‚\n\néš¾é“æ²¡æœ‰å…¼å¾—çš„æ–¹æ³•å—ï¼Œæ—¢å¯ä»¥æ¡ä»¶æ·»åŠ ï¼Œåˆä¸æ±¡æŸ“å…¨å±€ï¼Œæœ‰çš„ï¼Œå°† target é€‰é¡¹æ·»åŠ åˆ°é¡¶å±‚ï¼ŒæŠ½ç¦»ä½¿ç”¨ babel-polyfillsï¼Œå®ƒå¯ä»¥æŒ‡å®šä¸åŒçš„ polyfill providerï¼ˆç”±äºå†å²åŸå› ï¼ŒBabel ä¸€ç›´ç”¨çš„æ˜¯ core-jsï¼Œä½†æ˜¯ä¹Ÿæœ‰å…¶ä»–çš„ ployfill åº“ï¼Œå¦‚ es-shimsï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®š polyfill æ’å…¥çš„æ–¹å¼ï¼ŒåŒ…æ‹¬ä¸‰ç§ï¼š\n\n- entry-globalï¼šå¯¹åº” useBuiltIns: 'entry'\n- usage-globalï¼šå¯¹åº” useBuiltIns: 'usage'\n- usage-pureï¼šå¯¹åº” transform-runtimeï¼Œä½†æ˜¯å¯ä»¥è¯»å–åˆ° target ä¿¡æ¯ï¼Œå®ç°æ¡ä»¶å¼•å…¥\n\nä»“åº“åœ°å€ [Babel Polyfills](https://github.com/babel/babel-polyfills)ï¼Œæˆ‘å¼ºçƒˆæ¨èè¿™ç§æ–¹å¼ï¼Œå°†è¯­æ³•è½¬æ¢å’Œ polyfill åˆ†å¼€é…ç½®ï¼Œå„å¸å…¶èŒï¼Œæ’ä»¶é—´æ²¡æœ‰å†²çªã€‚\n\n```note\ntransform-runtime é™¤äº†å¯ä»¥æ·»åŠ å«ç‰‡ï¼Œè¿˜æä¾›äº†å„ç§ helperï¼Œè®©éœ€è¦ä½¿ç”¨åˆ° helper çš„åœ°æ–¹ç›´æ¥å¯¼å…¥ï¼Œè€Œä¸æ˜¯æ¯ä¸ªæ–‡ä»¶éƒ½ç”Ÿäº§ç±»ä¼¼çš„ä»£ç ï¼Œå‡å°‘æ–‡ä»¶çš„ä½“ç§¯ã€‚\n\nè¯¥åŠŸèƒ½ä¾èµ– @babel/runtimã€‚\n\nå¦‚æœéœ€è¦ç”¨ transform-runtime polyfill çš„è¯ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¾èµ– runtime-corejs2 æˆ– runtime-corejs3ã€‚\n```\n\nå‚è€ƒ:\n\n- [RFC: Rethink polyfilling story](https://github.com/babel/babel/issues/10008)\n",
      "preview": "<p>Babel çš„åŠŸèƒ½åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š</p>\n<ul>\n<li>è½¬æ¢è¯­æ³•</li>\n<li>polyfill æ–°çš„ APIï¼Œæ¯”å¦‚ Promise Set Map è¿™äº› API</li>\n</ul>\n<p>æ‰€æœ‰çš„è¿™äº›éƒ½æ˜¯é€šè¿‡æ’ä»¶æ¥å®ç°çš„ã€‚</p>\n<p>preset ä¸­åŒ…å«äº†å¤§é‡çš„æ’ä»¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸€ä¸ªä¸ªä¸‹è½½æ’ä»¶ï¼Œç„¶åé…ç½®ï¼Œç›´æ¥é…ç½® preset å°±å¯ä»¥äº†ï¼Œå¹¶ä¸”è¿˜ä¼šæ ¹æ® targetï¼Œæœ‰æ¡ä»¶çš„è½¬æ¢è¯­æ³•ï¼Œå¹¶ä¸æ˜¯æ¯ä¸ªè¯­æ³•éƒ½ä¼šè½¬æ¢ã€‚</p>\n<p>é™¤æ­¤ä¹‹å¤–ï¼Œpreset è¿˜å¯ä»¥é€šè¿‡ useBuiltIns é€‰é¡¹æ¥æ·»åŠ  polyfillï¼Œä¸è¿‡æ˜¯å…¨å±€æ·»åŠ çš„æ–¹å¼ã€‚</p>\n<p>å¯ä»¥é€šè¿‡æ’ä»¶ transform-runtime æ¥æ·»åŠ  polyfillï¼Œå®ƒä¸ä¼šæ·»åŠ åˆ°å…¨å±€ä¸­ï¼Œä»è€Œä¸ä¼šæ±¡æŸ“ç¯å¢ƒï¼Œä½†æ˜¯ä»–ä¸ä¼šæ ¹æ®ä½ çš„ taget æœ‰æ¡ä»¶çš„æ·»åŠ ï¼Œè€Œæ˜¯ä½ ç”¨åˆ°çš„éƒ½ä¼šæ·»åŠ ï¼Œæ¯”å¦‚ä½ çš„ taget æµè§ˆå™¨å·²ç»æ”¯æŒ Promise äº†ï¼Œä½†æ˜¯ transform-runtime è¿˜æ˜¯ä¼šæ·»åŠ ï¼Œä½†æ˜¯è¿™æ˜¯ä¸å¿…è¦ã€‚</p>\n<p>å®˜æ–¹æ–‡æ¡£çš„å»ºè®®æ˜¯ preset-env çš„ useBuiltin é€‰é¡¹å’Œ transform-runtime ä¸è¦åŒæ—¶ä½¿ç”¨ï¼Œä¸€èˆ¬åº“ä½œè€…ä¼šä½¿ç”¨ transform-runtimeï¼Œå› ä¸ºä¸ä¼šæ±¡æŸ“å…¨å±€ï¼Œè€Œåº”ç”¨ä¼šä½¿ç”¨ useBuiltInsï¼Œå› ä¸ºå¯ä»¥å‡å°‘ä½“ç§¯ã€‚</p>\n<p>éš¾é“æ²¡æœ‰å…¼å¾—çš„æ–¹æ³•å—ï¼Œæ—¢å¯ä»¥æ¡ä»¶æ·»åŠ ï¼Œåˆä¸æ±¡æŸ“å…¨å±€ï¼Œæœ‰çš„ï¼Œå°† target é€‰é¡¹æ·»åŠ åˆ°é¡¶å±‚ï¼ŒæŠ½ç¦»ä½¿ç”¨ babel-polyfillsï¼Œå®ƒå¯ä»¥æŒ‡å®šä¸åŒçš„ polyfill providerï¼ˆç”±äºå†å²åŸå› ï¼ŒBabel ä¸€ç›´ç”¨çš„æ˜¯ core-jsï¼Œä½†æ˜¯ä¹Ÿæœ‰å…¶ä»–çš„ ployfill åº“ï¼Œå¦‚ es-shimsï¼‰ï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®š polyfill æ’å…¥çš„æ–¹å¼ï¼ŒåŒ…æ‹¬ä¸‰ç§ï¼š</p>\n<ul>\n<li>entry-globalï¼šå¯¹åº” useBuiltIns: 'entry'</li>\n<li>usage-globalï¼šå¯¹åº” useBuiltIns: 'usage'</li>\n<li>usage-pureï¼šå¯¹åº” transform-runtimeï¼Œä½†æ˜¯å¯ä»¥è¯»å–åˆ° target ä¿¡æ¯ï¼Œå®ç°æ¡ä»¶å¼•å…¥</li>\n</ul>\n<p>ä»“åº“åœ°å€ <a aria-label-position=\"top\" aria-label=\"https://github.com/babel/babel-polyfills\" rel=\"noopener\" class=\"external-link\" href=\"https://github.com/babel/babel-polyfills\" target=\"_blank\">Babel Polyfills</a>ï¼Œæˆ‘å¼ºçƒˆæ¨èè¿™ç§æ–¹å¼ï¼Œå°†è¯­æ³•è½¬æ¢å’Œ polyfill åˆ†å¼€é…ç½®ï¼Œå„å¸å…¶èŒï¼Œæ’ä»¶é—´æ²¡æœ‰å†²çªã€‚</p>\n<div class=\"block-language-note custom-block note\"><p class=\"custom-block-title\">Note</p><p>transform-runtime é™¤äº†å¯ä»¥æ·»åŠ å«ç‰‡ï¼Œè¿˜æä¾›äº†å„ç§ helperï¼Œè®©éœ€è¦ä½¿ç”¨åˆ° helper çš„åœ°æ–¹ç›´æ¥å¯¼å…¥ï¼Œè€Œä¸æ˜¯æ¯ä¸ªæ–‡ä»¶éƒ½ç”Ÿäº§ç±»ä¼¼çš„ä»£ç ï¼Œå‡å°‘æ–‡ä»¶çš„ä½“ç§¯ã€‚</p>\n<p>è¯¥åŠŸèƒ½ä¾èµ– @babel/runtimã€‚</p>\n<p>å¦‚æœéœ€è¦ç”¨ transform-runtime polyfill çš„è¯ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¾èµ– runtime-corejs2 æˆ– runtime-corejs3ã€‚</p></div>\n<p>å‚è€ƒ:</p>\n<ul>\n<li><a aria-label-position=\"top\" aria-label=\"https://github.com/babel/babel/issues/10008\" rel=\"noopener\" class=\"external-link\" href=\"https://github.com/babel/babel/issues/10008\" target=\"_blank\">RFC: Rethink polyfilling story</a></li>\n</ul>",
      "tags": [
        "Babel",
        "polyfill"
      ],
      "createTime": 1675234841430,
      "updateTime": 1675236653524,
      "uuid": "7ec82ea7-f3c0-46db-9df7-f9d7305af1c9",
      "isCreated": true
    },
    {
      "content": "## The current relationship between Babel and core-js\n\nBabel is a compiler, `core-js` is a polyfill.\n\nA compiler is used to make modern syntax work in old browsers; a polyfill is used to make modern native functions work in old browsers. You usually want to use both, so that you can write modern code and run it in old browsers without problems.\n\nHowever, compilers and polyfills are two independent units. There are a lot of compiler you can choose (Babel, TypeScript, Traceur, swc, ...), and a lot of polyfills you can choose (core-js, es-shims, polyfill.io, ...).\n\nYou can choose them independently, but for historical reasons (and because `core-js` is a really good polyfill!) so far Babel has made it easier to use `core-js`.\n\n### What does the Babel compiler do with `core-js`?\n\nBabel internally does not depend on `core-js`. What it does is providing a simple way of automatically generate imports to `core-js` in your code.\n\nBabel provides a plugin to generate imports to core-js in your code. It's then your code that depends on `core-js`.\n\n```js\n// input (your code):\nSymbol();\n\n// output (your compiled code):\nimport \"core-js/modules/es.symbol\";\nSymbol();\n```\n\nIn order to generate those imports, we don't need to depend on core-js: we handle your code as if it was a simple string, similarly to how this function does:\n\n```js\nfunction addCoreJSImport(input) {\n  return `import \"core-js/modules/es.symbol\";\\n` + input;\n}\n```\n\n(well, it's not that simple! ğŸ˜›)\n\nBe careful though: even if Babel doesn't depend on core-js, your code will do!\n\nIs there any other way in which Babel directly depends on core-js?\n\nKind of. While the Babel compiler itself doesn't depend on core-js, we provide a few runtime packages that might be used at runtime by your application that depend on it.\n\n- @babel/polyfill is a \"proxy package\": all what it does is importing regenerator-runtime (a runtime helper used for generators) and core-js 2. This package has been deprecated at least since the release of core-js 3 in favor of the direct inclusion of those two other packages.\nOne of the reasons we deprecated it is that many users didn't understand that @babel/polyfill just imported core-js code, effectively not giving to the project the recognition it deserved.\n- (NOTE: @babel/runtime contains all the Babel runtime helpers.)\n- @babel/runtime-corejs2 is @babel/runtime + \"proxy files\" to core-js. Imports to this package are injected by @babel/plugin-transform-runtime, similarly to how @babel/preset-env injects imports to core-js.\n- @babel/runtime-corejs3 is the same, but depending on core-js-pure 3 (which is mostly core-js but without attaching polyfills to the global scope).\n\nWith the polyfill providers proposed in this RFC, we will just generate imports to core-js-pure when using @babel/plugin-transform-runtime rather than using the @babel/runtime-corejs3 \"proxy\".",
      "preview": "<h2 data-heading=\"The current relationship between Babel and core-js\">The current relationship between Babel and core-js</h2>\n<p>Babel is a compiler, <code>core-js</code> is a polyfill.</p>\n<p>A compiler is used to make modern syntax work in old browsers; a polyfill is used to make modern native functions work in old browsers. You usually want to use both, so that you can write modern code and run it in old browsers without problems.</p>\n<p>However, compilers and polyfills are two independent units. There are a lot of compiler you can choose (Babel, TypeScript, Traceur, swc, ...), and a lot of polyfills you can choose (core-js, es-shims, polyfill.io, ...).</p>\n<p>You can choose them independently, but for historical reasons (and because <code>core-js</code> is a really good polyfill!) so far Babel has made it easier to use <code>core-js</code>.</p>\n<h3 data-heading=\"What does the Babel compiler do with `core-js`?\">What does the Babel compiler do with <code>core-js</code>?</h3>\n<p>Babel internally does not depend on <code>core-js</code>. What it does is providing a simple way of automatically generate imports to <code>core-js</code> in your code.</p>\n<p>Babel provides a plugin to generate imports to core-js in your code. It's then your code that depends on <code>core-js</code>.</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js is-loaded\"><span class=\"token comment\">// input (your code):</span>\n<span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// output (your compiled code):</span>\n<span class=\"token keyword module\">import</span> <span class=\"token string\">\"core-js/modules/es.symbol\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token known-class-name class-name\">Symbol</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n</code><button class=\"copy-code-button\">å¤åˆ¶</button></pre>\n<p>In order to generate those imports, we don't need to depend on core-js: we handle your code as if it was a simple string, similarly to how this function does:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js is-loaded\"><span class=\"token keyword\">function</span> <span class=\"token function\">addCoreJSImport</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">input</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword control-flow\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">import \"core-js/modules/es.symbol\";\\n</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span> input<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code><button class=\"copy-code-button\">å¤åˆ¶</button></pre>\n<p>(well, it's not that simple! ğŸ˜›)</p>\n<p>Be careful though: even if Babel doesn't depend on core-js, your code will do!</p>\n<p>Is there any other way in which Babel directly depends on core-js?</p>\n<p>Kind of. While the Babel compiler itself doesn't depend on core-js, we provide a few runtime packages that might be used at runtime by your application that depend on it.</p>\n<ul>\n<li>@babel/polyfill is a \"proxy package\": all what it does is importing regenerator-runtime (a runtime helper used for generators) and core-js 2. This package has been deprecated at least since the release of core-js 3 in favor of the direct inclusion of those two other packages.\nOne of the reasons we deprecated it is that many users didn't understand that @babel/polyfill just imported core-js code, effectively not giving to the project the recognition it deserved.</li>\n<li>(NOTE: @babel/runtime contains all the Babel runtime helpers.)</li>\n<li>@babel/runtime-corejs2 is @babel/runtime + \"proxy files\" to core-js. Imports to this package are injected by @babel/plugin-transform-runtime, similarly to how @babel/preset-env injects imports to core-js.</li>\n<li>@babel/runtime-corejs3 is the same, but depending on core-js-pure 3 (which is mostly core-js but without attaching polyfills to the global scope).</li>\n</ul>\n<p>With the polyfill providers proposed in this RFC, we will just generate imports to core-js-pure when using @babel/plugin-transform-runtime rather than using the @babel/runtime-corejs3 \"proxy\".</p>",
      "tags": [
        "Babel",
        "polyfill",
        "core-js"
      ],
      "createTime": 1675215144785,
      "updateTime": 1675215144785,
      "uuid": "9ad6e113-7e1f-4753-b579-bf7e9785c998",
      "isCreated": true
    }
  ]
}